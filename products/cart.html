{% extends 'base.html' %}
{% block title %}–ö–æ—à–∏–∫{% endblock %}

{% block content %}
<div class="container mt-4">
  <h2 class="mb-4">üõí –í–∞—à –∫–æ—à–∏–∫</h2>

  {% if cart_items %}
    <div class="table-responsive shadow-sm rounded">
      <table class="table table-bordered align-middle mb-4">
        <thead class="table-light">
          <tr class="text-center">
            <th>üõç –¢–æ–≤–∞—Ä</th>
            <th>üí∞ –¶—ñ–Ω–∞</th>
            <th>üî¢ –ö—ñ–ª—å–∫—ñ—Å—Ç—å</th>
            <th>üì¶ –°—É–º–∞</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          {% for item in cart_items %}
            <tr>
              <td>
                <a href="{% url 'product_detail' item.product.pk %}" class="text-decoration-none">
                  {{ item.product.name }}
                </a>
              </td>
              <td class="text-center">{{ item.product.price }} –≥—Ä–Ω</td>
              <td class="text-center">{{ item.quantity }}</td>
              <td class="text-center"><strong>{{ item.subtotal }} –≥—Ä–Ω</strong></td>
              <td class="text-end">
                <div class="btn-group btn-group-sm" role="group">
                  <form action="{% url 'add_to_cart' item.product.pk %}" method="post">
                    {% csrf_token %}
                    <button class="btn btn-outline-success" title="–î–æ–¥–∞—Ç–∏">‚ûï</button>
                  </form>
                  <form action="{% url 'cart_decrease' item.product.pk %}" method="post">
                    {% csrf_token %}
                    <button class="btn btn-outline-warning" title="–ó–º–µ–Ω—à–∏—Ç–∏">‚ûñ</button>
                  </form>
                  <form action="{% url 'cart_remove' item.product.pk %}" method="post">
                    {% csrf_token %}
                    <button class="btn btn-outline-danger" title="–í–∏–¥–∞–ª–∏—Ç–∏">üóë</button>
                  </form>
                </div>
              </td>
            </tr>
          {% endfor %}
        </tbody>
        <tfoot class="table-light">
          <tr>
            <td colspan="3" class="text-end fw-bold">–†–∞–∑–æ–º:</td>
            <td colspan="2" class="fw-bold text-success">{{ total }} –≥—Ä–Ω</td>
          </tr>
        </tfoot>
      </table>
    </div>

    <div class="d-flex justify-content-between flex-wrap gap-2">
      <form action="{% url 'cart_clear' %}" method="post" class="mb-2">
        {% csrf_token %}
        <button class="btn btn-outline-danger">üßπ –û—á–∏—Å—Ç–∏—Ç–∏ –∫–æ—à–∏–∫</button>
      </form>

      {% if user.is_authenticated %}
        <a href="{% url 'checkout' %}" class="btn btn-primary">‚úÖ –û—Ñ–æ—Ä–º–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</a>
      {% else %}
        <a href="{% url 'login' %}?next={% url 'checkout' %}" class="btn btn-outline-primary">
          üîê –£–≤—ñ–π–¥—ñ—Ç—å, —â–æ–± –æ—Ñ–æ—Ä–º–∏—Ç–∏
        </a>
      {% endif %}
    </div>
  {% else %}
    <div class="alert alert-info shadow-sm mt-4">
      üòï –í–∞—à –∫–æ—à–∏–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π.
    </div>
    <a href="{% url 'product_list' %}" class="btn btn-secondary mt-2">‚Üê –ü–µ—Ä–µ–π—Ç–∏ –¥–æ —Ç–æ–≤–∞—Ä—ñ–≤</a>
  {% endif %}
</div>
{% endblock %}


